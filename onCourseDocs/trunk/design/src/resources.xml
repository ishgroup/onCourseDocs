<?xml version="1.0" encoding="UTF-8" ?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xi="http://www.w3.org/2001/XInclude"
	version="5.0" xml:id="templates">
	<title>Templates</title>
	<section>
		<title>Editing templates</title>
		<para>Once you have exhausted the capabilities of styling your site purely through modifying css,
			you may want to customise the html which is generated by the web application. To do
			this, you will edit the templates which are used to build the site. You can override any
			of the templates below, but don't go overboard: if you can achieve the results through
			modifying the css, do that first since it will be easier to upgrade your site to take
			advantage of new features as they become available in onCourse.</para>
		<para>If you want to override the templates below, simply place your modified files into an appropriate layout. For example to customise
			the body structure on the default template, create a file
			here:<programlisting>/resources/layouts/default/BodyStructure.tml</programlisting></para>
		<para>In onCourse templates are <emphasis role="bold">well formed XML documents</emphasis>. That means that every open tag must have a
			matching close tag, every attribute must be quoted, and so forth. You can override any of the templates in this handbook by simply
			creating a file with the appropriate name in the resources/layouts/default folder. Naturally if you are using more than one layout,
			you can have multiple sets of templates, each in their own folder within resources/layouts.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/templateStructure.png" format="png" />
			</imageobject>
			<caption>
				<para>The hierarchy of the templates is quite complex</para>
			</caption>
		</mediaobject>
	</section>
	<section>
		<title>Page wrappers</title>
		<para>All pages on the site are wrapped in one of two main templates. Most pages will have PageStructure.tml wrapped around them to
			render menus, headers, blocks, etc. Other web requests might be drawn inside a 'lightbox' effect and so should not have all this extra
			content.</para>
		<section>
			<title>Page Structure</title>
			<para>Page structure is one of the few templates that is not editable. You cannot override this particular template since it controls
				how the CMS integrates to the site. But you have enough other hooks that you should not need to worry about this template.</para>
			<para>
				<programlisting linenumbering="numbered" language="xml">&lt;!DOCTYPE html>
					&lt;html xmlns="http://www.w3.org/1999/xhtml" xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd"
					xmlns:p="tapestry:parameter" lang="en">
					&lt;head>
					&lt;head t:type="ui/pagehead" title="${title}"/>
					&lt;/head>
					
					&lt;body t:type="any" class="prop:agentAwareBodyClass" id="prop:bodyId">
					&lt;div  t:type="ui/BodyStructure" webNodeType="webNodeType">
					&lt;t:body/>
					&lt;/div>
					&lt;span t:type="ui/googleAnalytics">&lt;/span>
					&lt;/body>
					&lt;/html></programlisting>
			</para>
		</section>
		<section>
			<title>Body Structure</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>BodyStructure.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>The important thing about the body structure is that it is called by other page templates. So when Courses.tml wants to render
				itself, PageStructure is used to provide the main structure of the page. When you reach <code>&lt;t:body/></code> in the
				template below, Courses.tml is inserted.</para>
			<para>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/BodyStructure.tml" parse="text" /></programlisting>
			</para>
		</section>
		<section>
			<title>Dialog Structure</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>DialogStructure.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>This is a more minimalist page layout which is used for things that display in a 'lightbox' style dialog within the page. It
				contains no javascript references, but does include the main site.css stylesheet.</para>
			<para>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/DialogStructure.tml" parse="text" /></programlisting>
			</para>
		</section>
	</section>
	<section>
		<title>Page templates</title>
		<para>Some of the templates you can edit are reached by a particular URL. For example, the /course/ABC renders CourseDetails.tml. All of
			these top level page templates begin with something like
			this:<programlisting>&lt;html t:type="ui/pagestructure" title="Page title" bodyId="literal:DetailsPage"></programlisting></para>
		<para>This will render the template, wrapped with the PageStructure.tml template (to draw the main page design and layout), and give you
			the opportunity to override the page title and body css id.</para>
		<section>
			<title>Courses</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>Courses.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>URL: /courses/[tag]/[tag]/*</para>
			<para>URL: /courses?s=[search terms]</para>
			<para>Renders the course list after a user performs a search or browses the subject tags. The parameters in the URL define the
				position in the subject tag tree the user is looking at, or the search parameters they used. The first form of URL showing the list
				for a particular subject tag is deliberately designed to be Google friendly and encourage bookmarking.</para>
			<para>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../pages/Courses.tml" parse="text" /></programlisting>
			</para>
		</section>
		<section>
			<title>Course Details</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>CourseDetails.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>URL: /course/[course code]</para>
			<para>Renders a single course description page.</para>
			<para>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../pages/CourseDetails.tml" parse="text" /></programlisting>
			</para>
		</section>
		<section>
			<title>Class Details</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>CourseClassDetails.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>URL: /class/[class code]</para>
			<para>Renders a single class description page. For technical reasons a class is called "CourseClass" within the internals of
				onCourse.</para>
			<para>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../pages/CourseClassDetails.tml" parse="text" /></programlisting>
			</para>
		</section>
		<section>
			<title>Tutor Details</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>TutorDetails.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>URL: not public (ajax only)</para>
			<para>Renders a tutor profile in a lightbox.</para>
			<para>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../pages/TutorDetails.tml" parse="text" /></programlisting>
			</para>
		</section>
		<section>
			<title>Sites</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>Sites.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>URL: /sites</para>
			<para>When called, renders a listing of Course sites (venues) and appropriate maps.</para>
			<para>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../pages/Sites.tml" parse="text" /></programlisting>
			</para>
		</section>
		<section>
			<title>Site Details</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>SiteDetails.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>URL: /site/[id]</para>
			<para>Displays the details of the site including the map and site information.</para>
			<para>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../pages/SiteDetails.tml" parse="text" /></programlisting>
			</para>
		</section>
		<section>
			<title>Page Not Found</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>PageNotFound.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>URL: undefined</para>
			<para>Renders a page when the URL can not be found.</para>
			<para>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../pages/PageNotFound.tml" parse="text" /></programlisting>
			</para>
		</section>
		<section>
			<title>Promo Codes Page</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>PromoCodesPage.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>URL: not public (ajax only)</para>
			<para>Allows the user to enter a promotional code within a lightbox.</para>
			<para>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../pages/PromoCodesPage.tml" parse="text" /></programlisting>
			</para>
		</section>
		<section>
			<title>Room Details</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>RoomDetails.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>URL: /room/[id]</para>
			<para>Displays details about the room, including the site details.</para>
			<programlisting linenumbering="numbered" language="xml"><xi:include href="../pages/RoomDetails.tml" parse="text" /></programlisting>
		</section>
		<section>
			<title>Add Discount</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>AddDiscount.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>URL: not public (ajax only)</para>
			<para>Allows the user to enter a promotional code within a lightbox.</para>
			<para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/myDiscounts.png" format="png" />
					</imageobject>
					<caption>
						<para>Discount Redemption</para>
					</caption>
				</mediaobject>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../pages/AddDiscount.tml" parse="text" /></programlisting>
			</para>
		</section>
		<section>
			<title>Sitemap XML</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>SitemapXML.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>URL: /sitemap.xml</para>
			<para>Google, Bing, Yahoo and other search engines love this.</para>
			<para>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../pages/SitemapXML.tml" parse="text" /></programlisting>
			</para>
		</section>
	</section>
	<section>
		<title>Component templates</title>
		<para>These templates can never be called directly from an URL. Instead they are used by other templates to build up a page.</para>
		<section>
			<title>Block Display</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>BlockDisplay.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>Builds the parameters to include content - copy, images,
				components<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/BlockDisplay.tml" parse="text" /></programlisting></para>
		</section>
		<section>
			<title>Body Footer</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>BodyFooter.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>Builds the parameters for the Copyright, Disclaimer info, etc at the foot of the page
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/BodyFooter.tml" parse="text" /></programlisting>
			</para>
		</section>
		<section>
			<title>Body Header</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>BodyHeader.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>Builds the Header area for the mast - logo, navigation, search, etc at the top of the page.</para>
			<para>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/BodyHeader.tml" parse="text" /></programlisting>
			</para>
		</section>
		<section>
			<title>Class Item</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>CourseClassItem.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>Produces the brief, panelled class descriptions.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/classPanel.png" format="png" />
				</imageobject>
				<caption>
					<para>Snapshot display of Course Class and Class Times</para>
				</caption>
			</mediaobject>
			<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/CourseClassItem.tml" parse="text" /></programlisting>
		</section>
		<section>
			<title>Course Class Places Available</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>CourseClassPlacesAvailable.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>Produces a Class enrolment status display. Called by "CourseClassItem".</para>
			<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/CourseClassPlacesAvailable.tml" parse="text" /></programlisting>
		</section>
		<section>
			<title>Course Class Price</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>CourseClassPrice.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>Produces a class pricing display. Called by "CourseClassItem".</para>
			<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/CourseClassPrice.tml" parse="text" /></programlisting>
		</section>
		<section>
			<title>Course item</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>CourseItem.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>Produces a brief introduction to a Course Class</para>
			<para>Called by "Courses" and "CourseDetails"</para>
			<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/CourseItem.tml" parse="text" /></programlisting>
		</section>
		<section>
			<title>Course Search Form</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>CourseSearchForm.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>Produces a Course Class specific search</para>
			<para>Called by "BodyHeader" and in turn calls "Search Inputs"</para>
			<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/CourseSearchForm.tml" parse="text" /></programlisting>
		</section>
		<section>
			<title>Global Navi</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>GlobalNavi.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>Defines the parameters for global menus</para>
			<para>Called by "BodyStructure"</para>
			<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/GlobalNavi.tml" parse="text" /></programlisting>
		</section>
		<section>
			<title>Google Analytics</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>GoogleAnalytics.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>Places the appropriate Google Analytics code on the page </para>
			<para>Called by "CourseClassItem" in "CourseClassDetails"</para>
			<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/GoogleAnalytics.tml" parse="text" /></programlisting>
		</section>
		<section>
			<title>Google Map Sites</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>GoogleMapSites.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>Produces a Google map of the predefined site/sites/venue</para>
			<para>Called by "Courses" and "Sites" and in turn calls "GoogleDirections"</para>
			<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/GoogleMapSites.tml" parse="text" /></programlisting>
		</section>
		<section>
			<title>Google Directions</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>GoogleDirections.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>Produces directions - written and verbal for site directions </para>
			<para>Called by "GoogleMapSites" and "SiteDetailsComponent"</para>
			<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/GoogleDirections.tml" parse="text" /></programlisting>
		</section>
		<section>
			<title>Hint Component</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>HintComponent.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>Provides validation text (showing data entry errors) for forms throughout the application, but particularly within the enrolment
				process. </para>
			<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/HintComponent.tml" parse="text" /></programlisting>
		</section>
		<section>
			<title>Menu</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>Menu.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>Renders a Menu display. Called by "BodyStructure".</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/menuBase.png" format="png" />
				</imageobject>
				<caption>
					<para>Course Class</para>
				</caption>
			</mediaobject>
			<para>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/Menu.tml" parse="text" /></programlisting>
			</para>
		</section>
		<section>
			<title>Menu Item</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>MenuItem.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>Renders a specific menu. Called by "Menu"</para>
			<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/MenuItem.tml" parse="text" /></programlisting>
		</section>
		<section>
			<title>Page Head</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>PageHead.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/PageHead.tml" parse="text" /></programlisting>
		</section>
		<section>
			<title>Promo Codes View</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>PromoCodesView.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/PromoCodesView.tml" parse="text" /></programlisting>
		</section>
		<section>
			<title>Quick Search View</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>QuickSearchView.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>Produces specific parameters for the display of the page masthead </para>
			<para>Called by "PageStructure"</para>
			<programlisting linenumbering="numbered" language="xml"><xi:include href="../pages/QuickSearchView.tml" parse="text" /></programlisting>
		</section>
		<section>
			<title>Room Location</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>RoomLocation.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/RoomLocation.tml" parse="text" /></programlisting>
		</section>
		<section>
			<title>Room Location Text</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>RoomLocationText.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>Produces specific parameters for the display of the page masthead </para>
			<para>Called by "PageStructure"</para>
			<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/RoomLocationText.tml" parse="text" /></programlisting>
		</section>
		<section>
			<title>Search Criteria</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>SearchCriteria.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>Produces specific parameters for the display of the page masthead </para>
			<para>Called by "PageStructure"</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/srchOptions.png" format="png" />
				</imageobject>
				<caption>
					<para>Search Options</para>
				</caption>
			</mediaobject>
			<para>Produces specific parameters for the display of the page masthead </para>
			<para>Called by "PageStructure"</para>
			<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/SearchCriteria.tml" parse="text" /></programlisting>
		</section>
		<section>
			<title>Search Inputs</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>SearchInputs.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/SearchInputs.tml" parse="text" /></programlisting>
			</para>
		</section>
		<section>
			<title>Search Terms Clarification</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>SearchTermsClarification.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/SearchTermsClarification.tml" parse="text" /></programlisting>
			</para>
		</section>
		<section>
			<title>Shortlist</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>ShortList.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/mngClasses.png" format="png" />
					</imageobject>
					<caption>
						<para>Short List Manager</para>
					</caption>
				</mediaobject>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/ShortList.tml" parse="text" /></programlisting>
			</para>
		</section>
		<section>
			<title>Site Details Component</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>SiteDetailsComponent.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/SiteDetailsComponent.tml" parse="text" /></programlisting>
			</para>
		</section>
		<section>
			<title>Timeline Event Detail</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>TimelineEventDetail.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../pages/TimelineEventDetail.tml" parse="text" /></programlisting>
			</para>
		</section>
		<section>
			<title>Timetable Events</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>TimetableEvents.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/TimetableEvents.tml" parse="text" /></programlisting>
			</para>
		</section>
		<section>
			<title>Social Media</title>
			<variablelist>
				<varlistentry>
					<term>Filename</term>
					<listitem>
						<para>SocialMedia.tml</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<para>Allows the user to order the preferred buttons for the Add This social media links which are placed against course and static
				pages.</para>
			<para>
				<programlisting linenumbering="numbered" language="xml"><xi:include href="../components/SocialMedia.tml" parse="text" /></programlisting>
			</para>
		</section>
	</section>
</chapter>
