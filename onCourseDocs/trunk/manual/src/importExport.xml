<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="importExport">
	<title>Importing and exporting</title>
	<para>onCourse offers you a large number of ways to get data into and out of the system. One of the key advantages of onCourse is that the
		data is completely under your control.</para>
	<section>
		<title>Exporting</title>
		<section>
			<title>From the list view</title>
			<para>Each list view in onCourse has the ability to export data in an almost infinite variety of
				formats. Simply highlight the records you wish to export and choose "Import/Export >
				Export (tablename)" from under the File menu. A dialog will appear giving you some choices:<itemizedlist>
					<listitem>
						<para>Export format: This popup allows you to specify the format of the
							export data. For most data CSV and XML are the default options, but you
							are able to add as many additional export templates as you
							choose.</para>
					</listitem>
					<listitem>
						<para>Based on:<itemizedlist>
								<listitem>
									<para>All available records: every record of that type. So if
										you are exporting 'classes' then every class in the database
										will be exported. Careful, this could be a lot of data and
										might take some time to export as the information is sent
										from the server to the client and then saved to disk.</para>
								</listitem>
								<listitem>
									<para>Listed records: every record in the list you were just
										looking at. This is the result of whatever search you had
										just performed.</para>
								</listitem>
								<listitem>
									<para>Highlighted records: only those records you had
										highlighted in the list. This is the quickest way to export
										a few selected records, particularly when you need to choose
										them by hand from your query results.</para>
								</listitem>
							</itemizedlist></para>
					</listitem>
				</itemizedlist>onCourse enables you to export your data in raw XML format, this
				includes courses, classes, sessions, tutors, sites and rooms all of which can be
				easily be imported into a publishing product such as Adobe InDesign and customised
				however you wish. The resulting file can then be sent to the printing company of
				your choice. There are advanced instructions for importing and working with XML
				here. ish is also able to work with you to assist you in the production of printed
				course catalogues if do not have existing design or printing capabilities, or access
				to desktop publishing software.</para>
			<example>
				<title>Exporting Class Information</title>
			<para>Unlike the majority of List views within onCourse, the Class list view gives a number of
					additional detailed exports options that are available for you to run. In this
					example we will outline a sample of available exports. </para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/class_export_options.png"
						format="png" />
				</imageobject>
				<caption>
					<para>Available exports accessed via Class List</para>
				</caption>
			</mediaobject>
				<para>The steps involved in running these additional exports are the same as with any other export:
			<orderedlist>
				<listitem>
					<para>Select the Class records you wish to export information for from within the Class
								window.</para>
				</listitem>
				<listitem>
					<para>Go to <guimenuitem>File</guimenuitem>, <guimenuitem>Import/Export</guimenuitem>, <guimenuitem>Export Classes</guimenuitem></para>
				</listitem>
				<listitem>
					<para>You then have the following export options to select from the drop down menu:
					<itemizedlist>
						<listitem>
							<para>CSV - standard export of Class information</para>
							<mediaobject>
								<imageobject>
									<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/class_export_excel_output.png"
										format="png" />
								</imageobject>
								<caption>
									<para>Excerpt of standard Class export viewed via excel</para>
								</caption>
							</mediaobject>
						</listitem>
						<listitem>
							<para>Class Budget Summary - provides a Class per line summary of budgeted income and expenses against projected and actual costs.</para>
						<mediaobject>
							<imageobject>
								<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/class_budget_summary_excel_output.png"
									format="png" />
							</imageobject>
							<caption>
								<para>Excerpt of Class budget summary export viewed via excel</para>
							</caption>
						</mediaobject>
						</listitem>
						<listitem>
							<para>Class Outcomes CSV - Report for student outcome results for date range so Colleges can
											conduct their own reporting and easily identify students
											with outcomes that are not set.</para>
							<mediaobject>
								<imageobject>
									<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/outcomes_export_excel_output.png"
										format="png" />
								</imageobject>
								<caption>
									<para>Excerpt of student outcomes export viewed via excel </para>
								</caption>
							</mediaobject>
						</listitem>
					</itemizedlist>
					</para>
				</listitem>
			</orderedlist>
			</para>	
			</example>
			<tip>
				<para>When exporting the above three class exports, the resulting CSV output file will have the
					same name in all instances, it will be labelled as 'CourseClassExport.csv'. You
					can then re label these export files to whatever you need.</para>
			</tip>
			<example>
				<title>Exporting Invoice Information</title>
				<para>onCourse enables users to export not only the invoice information, with each invoice reflected as one line within the resulting output file, you can also export the invoice line detail.</para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/invoice_export_options.png"
							format="png" />
					</imageobject>
					<caption>
						<para>Available exports via the Invoice list</para>
					</caption>
				</mediaobject>
				<para>The steps involved in running these additional exports are the same as with any other export:
				<orderedlist>
					<listitem>
						<para>Select the invoice records you wish to export information for from within the Invoice window.</para>
					</listitem>
					<listitem>
						<para>Go to <guimenuitem>File</guimenuitem>, <guimenuitem>Import/Export</guimenuitem>, <guimenuitem>Export Invoices/Credit Notes</guimenuitem>.</para>
					</listitem>
					<listitem>
						<para>You can then export either the invoices as a standard CSV (one line per invoice) or
								alternatively you can export the invoice line detail.</para>
					</listitem>
				</orderedlist>
				</para>
			<para>The following excerpts of the exported information as shown within excel, provides a
					comparison between the kind of information that each export generates within the
					resulting output file. </para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/invoice_export_excel_excerpt.png"
						format="png" />
				</imageobject>
				<caption>
					<para>Excerpt of invoice export viewed via excel</para>
				</caption>
			</mediaobject>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/invoice_line_export_excel_excerpt.png"
							format="png"/>
					</imageobject>
					<caption>
						<para>Excerpt of invoice line export viewed via excel</para>
					</caption>
				</mediaobject>
			</example>
			<tip>
				<para>When exporting the above two invoice exports, the resulting CSV output file will have the
					same name in all instances, it will be labelled as 'InvoiceExport.csv'. You can
					then re label these export files to whatever you need.</para>
			</tip>
		</section>
		<section>
			<title>Direct access to the SQL database</title>
			<para>Although we largely recommend that you produce reports within onCourse itself, it is also possible to connect to the backend
				database directly. If you are using a third party database like MySQL or MS-SQL you will already know how to do this. If you are
				using the built in database which comes with onCourse server, use the following connection properties. Start with a tool such as
				Squirrel SQL or DBeaver and use them to browse your data. Once you have that working, you can use any reporting tool (JasperBI,
				Automate, Crystal Reports, etc) to extract and report on
				data.<programlisting>
	       JDBC Driver:  org.apache.derby.jdbc.ClientDriver
	       JDBC URL: jdbc:derby://&lt;server hostname&gt;/onCourse
	       username: report
	       password: 948ty
            </programlisting></para>
			<para>It is important to note that you should NEVER write to the database. Not only do you risk introducing bad data, but you bypass
				all of the onCourse 'business logic' which holds together the financial and relational integrity of the data.</para>
		</section>
		<section>
			<title>AVETMISS export</title>
			<para>To export your AVETMISS go to the file menu, select import/export and choose Export AVETMISS. Select the date range you wish to
				export and where you wish to export the files to, e.g. your desktop, and select proceed. The 10 txt files will then be created ready
				to be submitted to the government reporting agency of your choice. Easy as! </para>
			<para>For more information about how the onCourse data collection and various AVETMISS
				export options work, see the <xref xlink:href="#AVETMISS"> </xref> chapter. </para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/export_avetmiss.png" format="png" />
				</imageobject>
			</mediaobject>
		</section>
		<section>
			<title>Sending messages</title>
			<para>Although you can send emails and SMS directly from onCourse, you can also export a list of contact email and postal details so
				that you can use an external mailing system, mail merge in Word or send a list of addresses to an external mailing house. More
				details about how to export from the messages window can be found in <xref xlink:href="#messages" />.</para>
		</section>
		<section>
			<title>Exporting to Adobe Indesign</title>
			<para>onCourse already comes with a template for exporting to Adobe Indesign.</para>
			<para>
				<orderedlist>
					<listitem>
						<para>Open the class list view</para>
					</listitem>
					<listitem>
						<para>Use the searching feature to find the classes you want in your brochure. This might be one or a thousand classes.</para>
					</listitem>
					<listitem>
						<para>Choose "Import/Export" from the File menu and select "Export classes". Select the
							"Indesign Brochure" output format. Export this data and save it to disk
							somewhere. It will be an XML file, ready for inDesign.</para>
					</listitem>
				</orderedlist>
			</para>
			<para>Now fire up Adobe Indesign and import this file.<orderedlist>
					<listitem>
						<para>
							<menuchoice>
								<guimenuitem>File</guimenuitem>
								<guimenuitem>Import XML</guimenuitem>
							</menuchoice>
						</para>
					</listitem>
					<listitem>
						<para>Choose your XML file which you just exported from onCourse.</para>
					</listitem>
					<listitem>
						<para>Ticking “Link” will keep the InDesign document linked to your source XML so that changes to the XML flow through</para>
					</listitem>
					<listitem>
						<para>The structure of the data will now appear in the left column. You can drag any element into a text box in your layout and
							have the text automatically flow through.</para>
					</listitem>
					<listitem>
						<para>Use the “map tags to styles…” menu item to map the tags against your paragraph and character style sheets. Once this is
							done you can save the mapping so that next time you create this document with fresh data all the styles are linked quickly and
							simply.</para>
					</listitem>
				</orderedlist></para>
			<para>If you now spend a bit of time tidying up your stylesheets (both character styles and paragraph styles) in inDesign you can set
				up the whole process to be almost completely automated. Next time you export from onCourse, the data will flow right into inDesign
				complete with all the formatting you need. Just paginate your brochure, place in some pictures and you are done.</para>
			<para>When you are ready to customise your export further, read the following section on how to edit the export formatter.</para>
		</section>
		<section>
			<title>Custom export templates</title>
			<para>You've seen how easy it can be to export course information from onCourse. Now we'll go into a little more depth and you will be
				able to customise the output and create any type of publication you can dream of.</para>
			<para>If you have a publication you produce repeatedly you might like to automate the process of getting the text into the right
				format. XSLT is a technology which transforms XML according to a set of rules. Don't be overwhelmed by the acronyms: the process is
				simple enough. XML is the format of the data created by onCourse – a set of tags identify each element in the data. A &lt;course&gt;
				or &lt;startDate&gt; is a marker which let's you know what the information represents. There is no styling or design in the XML, it
				represents pure data with no prettiness. The XML from onCourse has a schema you can <link
					xlink:href="http://www.ish.com.au/s/schema/4/html/"> see here.</link></para>
			<para>You can create an XSL file which is a set of instructions on how to style that XML. The output is often more XML, but could be a
				web page, CSV, RSS feed, PDF file or even a Word document. XSL instructions can be used to create almost any type of document
				imaginable. Any material which comes from a database can be treated in this way – for example, the printed White Pages telephone
				directory (where it still exists!) is produced in this manner.</para>
			<para>XML and XSL can be a little daunting at first, but they offer the promise for huge savings in efforts particularly when
				preparing longer course guides and documents.</para>
			<para>Some things you can do with XSL:</para>
			<itemizedlist>
				<listitem>
					<para>Format date and time (eg. “2 Jan 2008”)</para>
				</listitem>
				<listitem>
					<para>Reorder elements</para>
				</listitem>
				<listitem>
					<para>Add extra text (eg. “82“ becomes “8 sessions of 2 hrs”)</para>
				</listitem>
				<listitem>
					<para>Remove elements (the sample XSL removes all the session information)</para>
				</listitem>
			</itemizedlist>
			<para>As an example, here is that the XML looks like directly from onCourse: <mediaobject>
					<imageobject><imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/XMLbefore.png" format="png" />
					</imageobject>
					<caption>
						<para> XML from onCourse. </para>
					</caption>
				</mediaobject></para>
			<para>And here is what it looks like after the inDesign transformation: <mediaobject>
					<imageobject>
						<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/XMLafter.png" format="png" />
					</imageobject>
					<caption>
						<para> After XSL transform. </para>
					</caption>
				</mediaobject></para>
		</section>
		<section>
			<title>Writing XSL</title>
			<para>Writing an XSL file from scratch can be tricky if you've never done it before. ish is able to offer services to produce a file
				for your needs or you may be able to find a local specialist. We recommend Oxygen for any serious editing and testing of XSL files.
				As a starting point, go to File -> Preferences. Choose the Export templates and double click on one of the templates. This will save
				the template to disk so that you can view and edit it. You will notice a block of XML at the top of the file which defines some
				basic parameters:</para>
			<para>
				<programlisting>	&lt;ish:onCourse>
		&lt;ish:name>CSV&lt;/ish:name>
		&lt;ish:entity>Contact&lt;/ish:entity>
		&lt;ish:version>6&lt;/ish:version>
		&lt;ish:keyCode>ish.onCourse.contactCsv&lt;/ish:keyCode>
	&lt;/ish:onCourse></programlisting>
			</para>
			<para>The "name" is the user visible name which appears in the export dialog. The "entity" defines which type of record can be
				formatted by this XSLT. The "version" is used to track your changes and the "keyCode" is a unique identifier for this export format.
				If you use an existing keyCode, then when you import your changed file it will replace the one already in onCourse. We recommend you
				change this to anything else to define your own formats.</para>
			<para>When you are ready, make sure your template conforms to <link xlink:href="http://www.ish.com.au/s/schema/4/html/"> our
					schema</link> and import your new template back into onCourse by clicking on the plus icon above the list of export
				templates.</para>
		</section>
	</section>
	<section xml:id="importExport-MYOB">
		<title>Exporting to MYOB</title>
		<para> If your organisation utilizes MYOB as the key financial system, you can generate an export
			that is specifically designed for importing data directly into MYOB. There are 2
			different pathways within the onCourse Client to access and generate the financial data
			export for MYOB.</para>
		<section>
			<title>Generating the Export via the Financial Summary Extract Menu</title>
			<para>The steps involved in running this export are as follows:</para>
<orderedlist>
	<listitem>
		<para>Go to Financial > Summary Extracts and select MYOB Export</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/MYOB_Export_via_Summary_Extract.png" format="png" />
			</imageobject>
			<caption>
				<para>Selecting MYOB Export via Summary Extract menu</para>
			</caption>
		</mediaobject>
	</listitem>
	<listitem>
		<para>Set the 'from' and 'to' date range for the next MYOB Export</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/MYOB_Export_set_date_range.png" format="png" />
			</imageobject>
			<caption>
				<para>Select date range for MYOB Export</para>
			</caption>
		</mediaobject>
		<note><para>The benefit of utilizing the Summary Extract path when exporting financial data, is that onCourse enables you to set the date range for the data that is to be exported. As well as remembering the date up to when the last data export was run. </para></note>
	</listitem>
	<listitem>
		<para>Click on the <guilabel>Export</guilabel>button to run the export. Note that the resulting
						file will be generated as a text file. </para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/MYOB_Export_data_output.png" format="png" />
			</imageobject>
			<caption>
				<para>Extract of MYOB Export viewed via Microsoft Excel</para>
			</caption>
		</mediaobject>
	</listitem>
</orderedlist>

			
			
		
		</section>
<section>
	<title>Generating the Export via the Transaction Window</title>
<para>Unlike the approach of generating the MYOB Export via the Summary Extract menu of onCourse, by
				running the export via the Transactions window, you can define exactly which
				transactions you wish to export to the resulting text file. The steps involved in
				running this export via the Transactions window are as follows: </para>
	<orderedlist>
		<listitem>
			<para>Filter and hilight the transaction records you wish to export within the Transaction
						window</para>
		</listitem>
		<listitem>
			<para>Go to File > Import/Export > Export Transactions to bring up the export dialog box</para>
		</listitem>
		<listitem>
			<para>Select <guilabel>MYOB</guilabel> from the drop down list of export formats</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/MYOB_Export_Window.png" format="png" />
				</imageobject>
				<caption>
					<para>Selecting MYOB Export from Import/Export dialog box</para>
				</caption>
			</mediaobject>	
		</listitem>
		<listitem>
			<para>Click on the <guilabel>Export</guilabel>button to run the export. Note that the resulting
				file will be generated as a text file. </para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" width="100%" contentdepth="100%" fileref="images/MYOB_Export_data_output.png" format="png" />
				</imageobject>
				<caption>
					<para>Extract of MYOB Export viewed via Microsoft Excel</para>
				</caption>
			</mediaobject>
		</listitem>
	</orderedlist>
	
</section>				
	</section>
	<section xml:id="importExport-import">
		<title>Importing</title>
		<para>There are a few options to import data into onCourse, they are:</para>
		<section>
			<title>AVETMISS 80/85</title>
			<orderedlist>
				<listitem>
					<para>Export AVETMISS 80 and 85 files from your legacy enrolment system </para>
				</listitem>
				<listitem>
					<para>Run onCourse client and choose “File” -> “Import/Export”. Select the two files you exported in step 1. </para>
				</listitem>
				<listitem>
					<para>This process can take a while if you have large numbers of students since each record is validated as it is imported.
					</para>
				</listitem>
			</orderedlist>
		</section>
		<section>
			<title>XML import</title>
			<para>Using a published XML format you will be able to migrate your data easily to onCourse, so long as you are able to export to this
				format from your existing system. This will bring across students, sites, rooms, courses, classes, tutors, enrolments and outcomes
				to onCourse. </para>
			<para> In order to perform this import, connect onCourse client to the server. After logging in, choose “File” -> “Import/Export” ->
				“Import XML”. Choose your XML data file and let the process run to completion (this will take some time for large datasets). It is
				usual to begin this process with a clean, empty data file, however that is not necessary. </para>
			<para> Note that the import process validates every record as it is imported. If validation errors occur (eg. a student birth date in
				the future) that record will be rejected and logged in an error file called "import.log" </para>
			<para>We also have the <link xlink:href="http://www.ish.com.au/s/oncourse-schema/dataImport.xsd">formal XML schema</link> and <link
					xlink:href="http://www.ish.com.au/s/oncourse-schema/dataImport.xsd.html">user friendly documentation</link> available from our
				website. </para>
			<para>Other legacy systems</para>
			<para>Please contact ish for tools which can help you export data from your legacy databases and import into onCourse. In the past we
				have created export helpers for systems such as GLEP. </para>
		</section>
	</section>
</chapter>
